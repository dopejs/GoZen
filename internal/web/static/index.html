<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoZen</title>
  <link rel="icon" href="favicon.ico">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-brand">
        <div class="brand-logo" role="img" aria-label="GoZen logo"></div>
        <div>
          <span class="brand-name">GoZen</span>
          <span class="brand-version" id="version"></span>
        </div>
      </div>
      <nav class="sidebar-nav">
        <button class="nav-item active" data-tab="providers">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="8" rx="2"/><rect x="2" y="14" width="20" height="8" rx="2"/><circle cx="6" cy="6" r="1"/><circle cx="6" cy="18" r="1"/></svg>
          <span>Providers</span>
        </button>
        <button class="nav-item" data-tab="profiles">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
          <span>Profiles</span>
        </button>
        <button class="nav-item" data-tab="logs">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
          <span>Logs</span>
        </button>
        <button class="nav-item" data-tab="usage">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          <span>Usage</span>
        </button>
        <button class="nav-item" data-tab="settings">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          <span>Settings</span>
        </button>
      </nav>
      <div class="sidebar-footer">
        <button class="nav-item nav-theme" id="btn-theme">
          <svg id="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
          <svg id="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <span id="theme-label">Light Mode</span>
        </button>
        <button class="nav-item nav-reload" id="btn-reload">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
          <span>Reload Config</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="main">
      <!-- Providers Tab -->
      <section id="tab-providers" class="tab-content active">
        <div class="page-header">
          <div>
            <h1>Providers</h1>
            <p class="page-desc">Manage your API provider configurations</p>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost" id="btn-refresh-providers">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
              Refresh
            </button>
            <button class="btn btn-primary" id="btn-add-provider">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Provider
            </button>
          </div>
        </div>
        <div id="providers-list"></div>
      </section>

      <!-- Profiles Tab -->
      <section id="tab-profiles" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Profiles</h1>
            <p class="page-desc">Manage provider groups and fallback order</p>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost" id="btn-refresh-profiles">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
              Refresh
            </button>
            <button class="btn btn-primary" id="btn-add-profile">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Profile
            </button>
          </div>
        </div>
        <div id="profiles-list"></div>
      </section>

      <!-- Provider Edit Page -->
      <section id="tab-provider-edit" class="tab-content">
        <div class="page-header">
          <div class="page-header-left">
            <button class="btn btn-icon btn-back" id="prov-back" title="Back to Providers">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><polyline points="12 19 5 12 12 5"/></svg>
            </button>
            <div>
              <h1 id="prov-title">Add Provider</h1>
              <p class="page-desc" id="prov-desc">Configure a new API provider</p>
            </div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost" id="prov-cancel">Cancel</button>
            <button class="btn btn-primary" id="prov-save">Save</button>
          </div>
        </div>
        <form id="prov-form">
          <div class="form-group" id="prov-name-group">
            <label for="prov-name">Name</label>
            <input type="text" id="prov-name" required autocomplete="off" placeholder="my-provider">
          </div>
          <div class="form-group">
            <label for="prov-type">API Type</label>
            <select id="prov-type">
              <option value="anthropic">Anthropic Messages API</option>
              <option value="openai">OpenAI Chat Completions API</option>
            </select>
          </div>
          <div class="form-group">
            <label for="prov-base-url">Base URL</label>
            <input type="url" id="prov-base-url" required placeholder="https://api.example.com">
          </div>
          <div class="form-group">
            <label for="prov-token">Auth Token</label>
            <input type="text" id="prov-token" autocomplete="off" placeholder="sk-...">
          </div>
          <div class="form-divider"><span>Model Overrides</span></div>
          <div class="form-row">
            <div class="form-group">
              <label for="prov-model">Default Model</label>
              <div class="ac-wrap">
                <input type="text" id="prov-model" placeholder="claude-sonnet-4-5" autocomplete="off" data-ac="models-default">
              </div>
            </div>
            <div class="form-group">
              <label for="prov-reasoning">Reasoning Model</label>
              <div class="ac-wrap">
                <input type="text" id="prov-reasoning" placeholder="claude-sonnet-4-5" autocomplete="off" data-ac="models-default">
              </div>
            </div>
          </div>
          <div class="form-row form-row-3">
            <div class="form-group">
              <label for="prov-haiku">Haiku</label>
              <div class="ac-wrap">
                <input type="text" id="prov-haiku" placeholder="claude-haiku-4-5" autocomplete="off" data-ac="models-haiku">
              </div>
            </div>
            <div class="form-group">
              <label for="prov-opus">Opus</label>
              <div class="ac-wrap">
                <input type="text" id="prov-opus" placeholder="claude-opus-4-5" autocomplete="off" data-ac="models-opus">
              </div>
            </div>
            <div class="form-group">
              <label for="prov-sonnet">Sonnet</label>
              <div class="ac-wrap">
                <input type="text" id="prov-sonnet" placeholder="claude-sonnet-4-5" autocomplete="off" data-ac="models-sonnet">
              </div>
            </div>
          </div>
          <div class="form-divider"><span>Environment Variables</span></div>
          <div class="env-tabs">
            <button type="button" class="env-tab active" data-cli="claude">Claude Code</button>
            <button type="button" class="env-tab" data-cli="codex">Codex</button>
            <button type="button" class="env-tab" data-cli="opencode">OpenCode</button>
          </div>
          <div class="env-tab-content" id="env-claude" style="display:block">
            <p class="env-hint">Environment variables for Claude Code:</p>
            <div class="env-presets">
              <button type="button" class="btn-preset" data-env="CLAUDE_CODE_MAX_OUTPUT_TOKENS" data-value="64000" data-cli="claude">Max Output Tokens</button>
              <button type="button" class="btn-preset" data-env="MAX_THINKING_TOKENS" data-value="50000" data-cli="claude">Max Thinking</button>
              <button type="button" class="btn-preset" data-env="ANTHROPIC_MAX_CONTEXT_WINDOW" data-value="1000000" data-cli="claude">Max Context</button>
              <button type="button" class="btn-preset" data-env="BASH_DEFAULT_TIMEOUT_MS" data-value="180000" data-cli="claude">Bash Timeout</button>
            </div>
            <div id="env-vars-claude"></div>
            <button type="button" class="btn btn-ghost btn-sm btn-add-env" data-cli="claude">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Variable
            </button>
          </div>
          <div class="env-tab-content" id="env-codex" style="display:none">
            <p class="env-hint">Environment variables for Codex (configured via config.toml, limited env var support):</p>
            <div id="env-vars-codex"></div>
            <button type="button" class="btn btn-ghost btn-sm btn-add-env" data-cli="codex">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Variable
            </button>
          </div>
          <div class="env-tab-content" id="env-opencode" style="display:none">
            <p class="env-hint">Environment variables for OpenCode:</p>
            <div class="env-presets">
              <button type="button" class="btn-preset" data-env="OPENCODE_EXPERIMENTAL_OUTPUT_TOKEN_MAX" data-value="64000" data-cli="opencode">Max Output Tokens</button>
              <button type="button" class="btn-preset" data-env="OPENCODE_EXPERIMENTAL_BASH_DEFAULT_TIMEOUT_MS" data-value="180000" data-cli="opencode">Bash Timeout</button>
            </div>
            <div id="env-vars-opencode"></div>
            <button type="button" class="btn btn-ghost btn-sm btn-add-env" data-cli="opencode">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Variable
            </button>
          </div>
        </form>
      </section>

      <!-- Profile Edit Page -->
      <section id="tab-profile-edit" class="tab-content">
        <div class="page-header">
          <div class="page-header-left">
            <button class="btn btn-icon btn-back" id="pe-back" title="Back to Profiles">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><polyline points="12 19 5 12 12 5"/></svg>
            </button>
            <div>
              <h1 id="pe-title">Edit Profile</h1>
              <p class="page-desc" id="pe-desc"></p>
            </div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost" id="pe-cancel">Cancel</button>
            <button class="btn btn-primary" id="pe-save">Save</button>
          </div>
        </div>
        <form id="pe-form">
          <div class="form-group" id="pe-name-group">
            <label for="pe-name">Name</label>
            <input type="text" id="pe-name" required autocomplete="off" placeholder="my-profile">
          </div>
          <div class="form-group">
            <label>Providers <span class="label-hint">(drag handle or arrows to reorder)</span></label>
            <div id="pe-providers" class="provider-selector"></div>
          </div>
          <div class="form-divider"><span>Scenario Routing (Optional)</span></div>
          <div id="pe-routing" class="routing-section"></div>
        </form>
      </section>

      <!-- Logs Tab -->
      <section id="tab-logs" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Logs</h1>
            <p class="page-desc">View proxy request logs and errors</p>
          </div>
          <div style="display:flex;gap:12px;align-items:center">
            <div class="auto-refresh-controls">
              <label class="toggle-switch">
                <input type="checkbox" id="logs-auto-refresh">
                <span class="toggle-slider"></span>
              </label>
              <span class="auto-refresh-label">Auto</span>
              <select id="logs-refresh-interval">
                <option value="5000">5s</option>
                <option value="10000" selected>10s</option>
                <option value="30000">30s</option>
                <option value="60000">60s</option>
              </select>
            </div>
            <button class="btn btn-ghost" id="btn-refresh-logs">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
              Refresh
            </button>
          </div>
        </div>
        <div class="logs-filters">
          <div class="filter-group">
            <label>Provider</label>
            <select id="logs-provider-filter">
              <option value="">All Providers</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Client</label>
            <select id="logs-client-filter">
              <option value="">All Clients</option>
              <option value="claude">Claude Code</option>
              <option value="codex">Codex</option>
              <option value="opencode">OpenCode</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Log Type</label>
            <select id="logs-type-filter">
              <option value="">All Logs</option>
              <option value="errors">Errors Only</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Status Code</label>
            <select id="logs-status-filter">
              <option value="">All Status</option>
              <option value="4xx">4xx (Client Errors)</option>
              <option value="5xx">5xx (Server Errors)</option>
              <option value="401">401 (Unauthorized)</option>
              <option value="403">403 (Forbidden)</option>
              <option value="429">429 (Rate Limited)</option>
              <option value="500">500 (Server Error)</option>
              <option value="502">502 (Bad Gateway)</option>
              <option value="529">529 (Overloaded)</option>
            </select>
          </div>
        </div>
        <div id="logs-list" class="logs-container"></div>
      </section>

      <!-- Usage Tab -->
      <section id="tab-usage" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Usage & Budget</h1>
            <p class="page-desc">Monitor API usage, costs, and provider health</p>
          </div>
          <div style="display:flex;gap:8px">
            <select id="usage-period">
              <option value="day">Today</option>
              <option value="week">This Week</option>
              <option value="month">This Month</option>
              <option value="all">All Time</option>
            </select>
            <button class="btn btn-ghost" id="btn-refresh-usage">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
              Refresh
            </button>
          </div>
        </div>

        <!-- Summary Cards -->
        <div class="usage-summary" id="usage-summary">
          <div class="usage-card">
            <div class="usage-card-icon teal">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
            </div>
            <div class="usage-card-content">
              <div class="usage-card-value" id="usage-total-cost">$0.00</div>
              <div class="usage-card-label">Total Cost</div>
            </div>
          </div>
          <div class="usage-card">
            <div class="usage-card-icon lavender">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            </div>
            <div class="usage-card-content">
              <div class="usage-card-value" id="usage-total-input">0</div>
              <div class="usage-card-label">Input Tokens</div>
            </div>
          </div>
          <div class="usage-card">
            <div class="usage-card-icon sage">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </div>
            <div class="usage-card-content">
              <div class="usage-card-value" id="usage-total-output">0</div>
              <div class="usage-card-label">Output Tokens</div>
            </div>
          </div>
          <div class="usage-card">
            <div class="usage-card-icon amber">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
            </div>
            <div class="usage-card-content">
              <div class="usage-card-value" id="usage-total-requests">0</div>
              <div class="usage-card-label">Requests</div>
            </div>
          </div>
        </div>

        <!-- Budget Status -->
        <div class="usage-section">
          <h3>Budget Status</h3>
          <div id="budget-status" class="budget-status-container"></div>
        </div>

        <!-- Provider Health -->
        <div class="usage-section">
          <h3>Provider Health</h3>
          <div id="provider-health" class="provider-health-grid"></div>
        </div>

        <!-- Usage by Provider -->
        <div class="usage-section">
          <h3>Usage by Provider</h3>
          <div id="usage-by-provider" class="usage-breakdown"></div>
        </div>

        <!-- Usage by Model -->
        <div class="usage-section">
          <h3>Usage by Model</h3>
          <div id="usage-by-model" class="usage-breakdown"></div>
        </div>
      </section>

      <!-- Settings Tab -->
      <section id="tab-settings" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Settings</h1>
            <p class="page-desc">Configure global settings and project bindings</p>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost" id="btn-refresh-settings">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
              Refresh
            </button>
            <button class="btn btn-primary" id="btn-save-settings">Save Settings</button>
          </div>
        </div>
        <form id="settings-form">
          <div class="form-group">
            <label for="settings-default-client">Default Client</label>
            <select id="settings-default-client">
              <option value="claude">Claude Code</option>
              <option value="codex">Codex</option>
              <option value="opencode">OpenCode</option>
            </select>
          </div>
          <div class="form-group">
            <label for="settings-default-profile">Default Profile</label>
            <select id="settings-default-profile"></select>
          </div>
          <div class="form-group">
            <label for="settings-web-port">Web UI Port</label>
            <input type="number" id="settings-web-port" min="1024" max="65535" placeholder="19840">
            <p class="form-hint">Changes require restart of the web server</p>
          </div>
        </form>

        <div class="form-divider"><span>Security</span></div>
        <form id="password-form">
          <div class="form-group">
            <label for="settings-old-password">Current Password</label>
            <input type="password" id="settings-old-password" autocomplete="current-password" placeholder="Enter current password">
          </div>
          <div class="form-group">
            <label for="settings-new-password">New Password</label>
            <input type="password" id="settings-new-password" autocomplete="new-password" placeholder="Enter new password (min 6 characters)">
          </div>
          <button type="submit" class="btn btn-secondary" id="btn-change-password">Change Password</button>
        </form>

        <div class="form-divider"><span>Project Bindings</span></div>
        <p class="section-desc">Bind directories to specific profiles and clients. When running <code>zen</code> in a bound directory, it will automatically use the configured settings.</p>
        <div class="bindings-header">
          <button class="btn btn-ghost btn-sm" id="btn-add-binding">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add Binding
          </button>
        </div>
        <div id="bindings-list" class="bindings-container"></div>

        <div class="form-divider"><span>Config Sync</span></div>
        <p class="section-desc">Sync providers, profiles, and settings across devices. Tokens are encrypted with AES-256-GCM before upload.</p>
        <div id="sync-status-bar" class="sync-status-bar" style="display:none"></div>
        <form id="sync-form">
          <div class="form-group">
            <label for="sync-backend">Backend</label>
            <select id="sync-backend">
              <option value="">Disabled</option>
              <option value="webdav">WebDAV</option>
              <option value="s3">S3</option>
              <option value="gist">GitHub Gist</option>
              <option value="repo">GitHub Repo</option>
            </select>
          </div>
          <div id="sync-fields-webdav" class="sync-backend-fields" style="display:none">
            <div class="form-group">
              <label for="sync-webdav-endpoint">WebDAV URL</label>
              <input type="url" id="sync-webdav-endpoint" placeholder="https://dav.example.com/zen-sync.json" autocomplete="off">
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="sync-webdav-username">Username</label>
                <input type="text" id="sync-webdav-username" autocomplete="off">
              </div>
              <div class="form-group">
                <label for="sync-webdav-password">Password</label>
                <input type="password" id="sync-webdav-password" autocomplete="off">
              </div>
            </div>
          </div>
          <div id="sync-fields-s3" class="sync-backend-fields" style="display:none">
            <div class="form-row">
              <div class="form-group">
                <label for="sync-s3-endpoint">S3 Endpoint</label>
                <input type="text" id="sync-s3-endpoint" placeholder="s3.amazonaws.com" autocomplete="off">
              </div>
              <div class="form-group">
                <label for="sync-s3-region">Region</label>
                <input type="text" id="sync-s3-region" placeholder="us-east-1" autocomplete="off">
              </div>
            </div>
            <div class="form-group">
              <label for="sync-s3-bucket">Bucket</label>
              <input type="text" id="sync-s3-bucket" placeholder="my-zen-sync" autocomplete="off">
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="sync-s3-access-key">Access Key</label>
                <input type="text" id="sync-s3-access-key" autocomplete="off">
              </div>
              <div class="form-group">
                <label for="sync-s3-secret-key">Secret Key</label>
                <input type="password" id="sync-s3-secret-key" autocomplete="off">
              </div>
            </div>
          </div>
          <div id="sync-fields-gist" class="sync-backend-fields" style="display:none">
            <div class="form-group">
              <label for="sync-gist-token">GitHub PAT <span class="label-hint">(<a href="https://github.com/settings/tokens/new?scopes=gist&description=GoZen+Sync" target="_blank" rel="noopener">create token</a> with <code>gist</code> scope)</span></label>
              <input type="password" id="sync-gist-token" autocomplete="off" placeholder="ghp_...">
            </div>
            <div class="form-group">
              <label for="sync-gist-id">Gist ID <span class="label-hint">(or create one automatically)</span></label>
              <div style="display:flex;gap:8px">
                <input type="text" id="sync-gist-id" autocomplete="off" placeholder="abc123..." style="flex:1">
                <button type="button" class="btn btn-ghost btn-sm" id="btn-create-gist">Create Gist</button>
              </div>
            </div>
          </div>
          <div id="sync-fields-repo" class="sync-backend-fields" style="display:none">
            <div class="form-group">
              <label for="sync-repo-token">GitHub PAT <span class="label-hint">(<a href="https://github.com/settings/tokens/new?scopes=repo&description=GoZen+Sync" target="_blank" rel="noopener">create token</a> with <code>repo</code> scope)</span></label>
              <input type="password" id="sync-repo-token" autocomplete="off" placeholder="ghp_...">
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="sync-repo-owner">Owner</label>
                <input type="text" id="sync-repo-owner" autocomplete="off" placeholder="username">
              </div>
              <div class="form-group">
                <label for="sync-repo-name">Repository</label>
                <input type="text" id="sync-repo-name" autocomplete="off" placeholder="my-zen-config">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="sync-repo-path">File Path</label>
                <input type="text" id="sync-repo-path" autocomplete="off" placeholder="zen-sync.json">
              </div>
              <div class="form-group">
                <label for="sync-repo-branch">Branch</label>
                <input type="text" id="sync-repo-branch" autocomplete="off" placeholder="main">
              </div>
            </div>
          </div>
          <div id="sync-common-fields" style="display:none">
            <div class="form-group">
              <label for="sync-passphrase">Encryption Passphrase</label>
              <input type="password" id="sync-passphrase" autocomplete="off" placeholder="Enter passphrase to encrypt tokens">
              <p class="form-hint">Used to encrypt auth tokens before upload. Must be the same on all devices.</p>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="toggle-label">
                  <label class="toggle-switch">
                    <input type="checkbox" id="sync-auto-pull">
                    <span class="toggle-slider"></span>
                  </label>
                  Auto Pull
                </label>
              </div>
              <div class="form-group">
                <label for="sync-pull-interval">Pull Interval</label>
                <select id="sync-pull-interval">
                  <option value="60">1 min</option>
                  <option value="300" selected>5 min</option>
                  <option value="600">10 min</option>
                  <option value="1800">30 min</option>
                </select>
              </div>
            </div>
          </div>
        </form>
        <div id="sync-actions" class="sync-actions" style="display:none">
          <button class="btn btn-primary" id="btn-save-sync">Save Sync Settings</button>
          <button class="btn btn-ghost" id="btn-test-sync">Test Connection</button>
          <button class="btn btn-ghost" id="btn-sync-pull">Pull Now</button>
          <button class="btn btn-ghost" id="btn-sync-push">Push Now</button>
        </div>
      </section>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div id="confirm-modal" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h2>Confirm Delete</h2>
        <button class="btn-close modal-close" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="confirm-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
        </div>
        <p id="confirm-message"></p>
        <div class="modal-footer">
          <button class="btn btn-ghost modal-cancel" id="confirm-cancel">Cancel</button>
          <button class="btn btn-danger" id="confirm-ok">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add to Profiles Modal -->
  <div id="add-to-profiles-modal" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h2>Add to Profiles</h2>
        <button class="btn-close modal-close" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <p class="add-profiles-desc">Select profiles to add this provider to:</p>
        <div id="atp-profiles" class="profile-checklist"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost" id="atp-skip">Skip</button>
          <button type="button" class="btn btn-primary" id="atp-confirm">Add</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Binding Edit Modal -->
  <div id="binding-modal" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h2 id="binding-modal-title">Add Binding</h2>
        <button class="btn-close modal-close" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <form id="binding-form">
          <div class="form-group" id="binding-path-group">
            <label for="binding-path">Directory Path</label>
            <input type="text" id="binding-path" required autocomplete="off" placeholder="/path/to/project">
          </div>
          <div class="form-group">
            <label for="binding-profile">Profile</label>
            <select id="binding-profile">
              <option value="">(Use default)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="binding-client">Client</label>
            <select id="binding-client">
              <option value="">(Use default)</option>
              <option value="claude">Claude Code</option>
              <option value="codex">Codex</option>
              <option value="opencode">OpenCode</option>
            </select>
          </div>
        </form>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost modal-cancel">Cancel</button>
          <button type="button" class="btn btn-primary" id="binding-save">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast container -->
  <div id="toast-container"></div>

  <script src="app.js"></script>
</body>
</html>
